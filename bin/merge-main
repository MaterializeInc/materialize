#!/usr/bin/env bash
# Copyright Materialize, Inc. All rights reserved.
#
# Use of this software is governed by the Business Source License
# included in the LICENSE file at the root of this repository.
#
# As of the Change Date specified in that file, in accordance with
# the Business Source License, use of this software will be governed
# by the Apache License, Version 2.0.
#
# merge-main: ensure that both master and main are in sync in github

set -euo pipefail

PUSH=${1:-}

git fetch origin

if git merge-base --is-ancestor main master; then
    git checkout main
    git merge origin/master
else
    git checkout master
    git merge oigin/main
fi

if [[ $PUSH ]]; then
    git push origin main
    git push origin master
fi
