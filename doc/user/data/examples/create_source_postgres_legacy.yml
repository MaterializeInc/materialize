- name: "syntax"
  code: |
    CREATE SOURCE [IF NOT EXISTS] <src_name>
    [IN CLUSTER <cluster_name>]
    FROM POSTGRES CONNECTION <connection_name> (
      PUBLICATION '<publication_name>'
      [, TEXT COLUMNS ( <col1> [, ...] ) ]
      [, EXCLUDE COLUMNS ( <col1> [, ...] ) ]
    )
    <FOR ALL TABLES | FOR SCHEMAS ( <schema1> [, ...] ) | FOR TABLES ( <table1> [AS <subsrc_name>] [, ...] )>
    [EXPOSE PROGRESS AS <progress_subsource_name>]
    [WITH (RETAIN HISTORY FOR <retention_period>)]
  syntax_elements:
    - name: "`<src_name>`"
      description: |
        The name for the source.
    - name: "**IF NOT EXISTS**"
      description: |
        Optional. If specified, do not throw an error if a source with the same name already exists. Instead, issue a notice and skip the source creation.
    - name: "**IN CLUSTER** `<cluster_name>`"
      description: |
        Optional. The [cluster](/sql/create-cluster) to maintain this source.
    - name: "**CONNECTION** `<connection_name>`"
      description: |
        The name of the PostgreSQL connection to use in the source. For details on creating connections, check the [`CREATE CONNECTION`](/sql/create-connection/#postgresql) documentation page.
    - name: "**PUBLICATION** `'<publication_name>'`"
      description: |
        The PostgreSQL [publication](https://www.postgresql.org/docs/current/logical-replication-publication.html) (the replication data set containing the tables to be streamed to Materialize).
    - name: "**TEXT COLUMNS** ( `<col1>` [, ...] )"
      description: |
        Optional. Decode data as `text` for specific columns that contain PostgreSQL types that are unsupported in Materialize.
    - name: "**EXCLUDE COLUMNS** ( `<col1>` [, ...] )"
      description: |
        Optional. Exclude specific columns that cannot be decoded or should not be included in the subsources created in Materialize.
    - name: "**FOR** `<table_schema_specification>`"
      description: |
        Specifies which tables to create subsources for. The following `<table_schema_specification>`s are supported:

        | Option | Description |
        |--------|-------------|
        | `ALL TABLES` | Create subsources for all tables in the publication. |
        | `SCHEMAS ( <schema1> [, ...] )` | Create subsources for specific schemas in the publication. |
        | `TABLES ( <table1> [AS <subsrc_name>] [, ...] )` | Create subsources for specific tables in the publication. |
    - name: "**EXPOSE PROGRESS AS** `<progress_subsource_name>`"
      description: |
        Optional. The name of the progress collection for the source. If this is not specified, the progress collection will be named `<src_name>_progress`. For more information, see [Monitoring source progress](#monitoring-source-progress).
    - name: "**WITH** (`<with_option>` [, ...])"
      description: |
        Optional. The following `<with_option>`s are supported:

        | Option | Description |
        |--------|-------------|
        | `RETAIN HISTORY FOR <retention_period>` | ***Private preview.** This option has known performance or stability issues and is under active development.* Duration for which Materialize retains historical data, which is useful to implement [durable subscriptions](/transform-data/patterns/durable-subscriptions/#history-retention-period). Accepts positive [interval](/sql/types/interval/) values (e.g. `'1hr'`). Default: `1s`. |
