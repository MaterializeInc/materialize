---
title: "CREATE SOURCE: JSON over Kinesis"
description: "Learn how to connect Materialize to an Avro-formatted Kafka topic"
menu:
  main:
    parent: 'create-source'
aliases:
    - /docs/sql/create-source/kinesis
---

`CREATE SOURCE` connects Materialize to some data source, and lets you interact
with its data as if it were in a SQL table.

This document details how to connect Materialize to a stream of JSON data over
AWS Kinesis. For other options, view [`CREATE  SOURCE`](../).

## Conceptual framework

Sources represent connections to resources outside Materialize that it can read
data from. For more information, see [API Components:
Sources](../../../overview/api-components#sources).

## Syntax

{{< diagram "create-source-kinesis.html" >}}

Field | Use
------|-----
_src&lowbar;name_ | The name for the source, which is used as its table name within SQL.
**KINESIS ARN** _arn_ | The [AWS ARN](https://docs.aws.amazon.com/general/latest/gr/aws-arns-and-namespaces.html) of the Kinesis Data Stream.
**WITH (** _option&lowbar;list_ **)** | Options affecting source creation. For more detail, see [`WITH` options](#with-options).

#### `WITH` options

The following options are valid within the `WITH` clause.

Field | Value | Description
------|-------|------------
`access_key` | `text` | _(Required)_ A valid [access key](https://docs.aws.amazon.com/streams/latest/dev/controlling-access.html) to the Kinesis stream.
`secret_access_key` | `text` | _(Required)_ A valid [secret access key](https://docs.aws.amazon.com/streams/latest/dev/controlling-access.html) to the Kinesis stream.

For details about the IAM account whose details you provide, see [Kinesis source
details](#kinesis-source-details).

## Details

This document assumes you're using Kafka to send JSON data to Materialize.

### Kinesis source details

- Materialize expects each source to use to one Kinesis stream, which
  is&mdash;in turn&mdash;generated by a single table in an upstream database.
- **Permissions**: The IAM account whose credentials you provide requires
  `kinesis-read` permissions and access to `ListStreams` and `Read`.
- Kinesis sources will only have one column, which will be named `data`.

### Byte format details

Materialize receives all data from Kinesis streams as bytes, which you must
convert to [`text`](/docs/sql/data-types/text), and then to
[`jsonb`](/docs/sql/data-types/jsonb).

Here is an example of using a Kinesis source, converting the streams bytes into
`jsonb` data:

```sql
CREATE MATERIALIZED VIEW jsonified_kinesis_source AS
SELECT CAST(data AS JSONB) AS data
FROM (
    SELECT CONVERT_FROM(data, 'utf8') AS data
    FROM kinesis_source
)
```

### Envelope details

Envelopes determine whether an incoming record inserts new data, updates or
deletes existing data, or both. For more information, see [API Components:
Envelopes](../../../overview/api-components#envelopes).

JSON data sent over Kinesis can currently only be handled as append-only by
Materialize.

## Examples

```sql
CREATE SOURCE kinesis_source
FROM KINESIS ARN ...
WITH (access_key=...,
             secret_access_key=...)
FORMAT BYES;
```

This creates a source that...

- Is append-only.
- Has one column, `data`, which represents the stream's incoming bytes.

To use this data in views, you can decode its bytes into
[`jsonb`](/docs/sql/data-types/jsonb). For example:

```sql
CREATE MATERIALIZED VIEW jsonified_kinesis_source AS
SELECT CAST(data AS JSONB) AS data
FROM (
    SELECT CONVERT_FROM(data, 'utf8') AS data
    FROM kinesis_source
)
```

## Related pages

- [`CREATE SOURCE`](../)
- [`CREATE VIEW`](../../create-view)
- [`SELECT`](../../select)
