CREATE MATERIALIZED VIEW billing_agg_by_month AS
SELECT date_trunc as month, client_id, meter, cpu_num, memory_gb, disk_gb, sum(value) as value
FROM billing_agg_by_day
GROUP BY date_trunc('month', day::timestamp), client_id, meter, cpu_num, memory_gb, disk_gb;
