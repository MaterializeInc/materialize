[package]
name = "mz-prof"
description = "CPU and memory profiling tools."
version = "0.0.0"
edition.workspace = true
rust-version.workspace = true
publish = false

[dependencies]
askama = { workspace = true, default-features = false, features = ["config", "serde-json"] }
anyhow = { workspace = true }
axum = { workspace = true, features = ["headers"] }
backtrace = { workspace = true }
bytesize = { workspace = true }
cfg-if = { workspace = true }
headers = { workspace = true }
http = { workspace = true }
include_dir = { workspace = true }
libc = { workspace = true }
once_cell = { workspace = true }
mime = { workspace = true }
mz-build-info = { workspace = true }
mz-http-util = { workspace = true }
mz-ore = { workspace = true }
pprof = { workspace = true }
serde = { workspace = true, features = ["derive"] }
tempfile = { workspace = true }
tikv-jemalloc-ctl = { workspace = true, features = ["use_std"], optional = true }
tracing = { workspace = true }
tokio = { workspace = true, features = ["time"] }
workspace-hack = { version = "0.0.0", path = "../workspace-hack" }

[build-dependencies]
anyhow = { workspace = true }
mz-npm = { workspace = true }

[features]
# When enabled, static assets for the web UI are loaded from disk on every HTTP
# request rather than compiled into the binary. This vastly speeds up the
# iteration cycle when developing the web UI.
#
# WARNING: For development use only! When enabled, may allow unrestricted read
# access to the file system.
dev-web = []
# Whether to enable profiling features that depend on jemalloc.
jemalloc = ["tikv-jemalloc-ctl"]

[package.metadata.cargo-udeps.ignore]
# "bytesize" not used on linux
normal = ["bytesize", "workspace-hack"]
