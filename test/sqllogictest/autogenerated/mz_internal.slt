
# Copyright Materialize, Inc. and contributors. All rights reserved.
#
# Use of this software is governed by the Business Source License
# included in the LICENSE file at the root of this repository.
#
# As of the Change Date specified in that file, in accordance with
# the Business Source License, use of this software will be governed
# by the Apache License, Version 2.0.

# This file is auto-generated by ci/test/lint-internal-views.py

mode cockroach

statement ok
CREATE VIEW objects AS
  SELECT
    schema.name AS schema,
    objects.name AS object,
    columns.position,
    columns.name,
    columns.type
  FROM
    mz_catalog.mz_columns AS columns,
    mz_catalog.mz_objects AS objects,
    mz_catalog.mz_schemas AS schema
  WHERE columns.id = objects.id AND objects.schema_id = schema.id

statement ok
CREATE INDEX objects_idx ON objects(schema, object)

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_cluster_replica_metrics' ORDER BY position
----
1  replica_id  text
2  process_id  uint8
3  cpu_nano_cores  uint8
4  memory_bytes  uint8
5  disk_bytes  uint8

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_cluster_replica_sizes' ORDER BY position
----
1  size  text
2  processes  uint8
3  workers  uint8
4  cpu_nano_cores  uint8
5  memory_bytes  uint8
6  disk_bytes  uint8
7  credits_per_hour  numeric

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_cluster_links' ORDER BY position
----
1  cluster_id  text
2  object_id  text

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_cluster_replica_statuses' ORDER BY position
----
1  replica_id  text
2  process_id  uint8
3  status  text
4  reason  text
5  updated_at  timestamp␠with␠time␠zone

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_cluster_replica_utilization' ORDER BY position
----
1  replica_id  text
2  process_id  uint8
3  cpu_percent  double␠precision
4  memory_percent  double␠precision
5  disk_percent  double␠precision

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_cluster_replica_frontiers' ORDER BY position
----
1  replica_id  text
2  export_id   text
3  time  mz_timestamp

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_cluster_replica_heartbeats' ORDER BY position
----
1  replica_id  text
2  last_heartbeat  timestamp␠with␠time␠zone

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_cluster_replica_history' ORDER BY position
----
1  internal_replica_id  text
2  size  text
3  cluster_name  text
4  replica_name  text
5  created_at  timestamp␠with␠time␠zone
6  dropped_at  timestamp␠with␠time␠zone
7  credits_per_hour  numeric

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_kafka_sources' ORDER BY position
----
1  id  text
2  group_id_base  text

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_object_dependencies' ORDER BY position
----
1  object_id  text
2  referenced_object_id  text

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_object_transitive_dependencies' ORDER BY position
----
1  object_id  text
2  referenced_object_id  text

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_postgres_sources' ORDER BY position
----
1  id  text
2  replication_slot  text

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_sessions' ORDER BY position
----
1  id  uint4
2  role_id  text
3  connected_at  timestamp␠with␠time␠zone

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_sink_statistics' ORDER BY position
----
1  id  text
2  worker_id  uint8
3  messages_staged  uint8
4  messages_committed  uint8
5  bytes_staged  uint8
6  bytes_committed  uint8

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_sink_statuses' ORDER BY position
----
1  id  text
2  name  text
3  type  text
4  last_status_change_at  timestamp␠with␠time␠zone
5  status  text
6  error  text
7  details  jsonb

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_sink_status_history' ORDER BY position
----
1  occurred_at  timestamp␠with␠time␠zone
2  sink_id  text
3  status  text
4  error  text
5  details  jsonb

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_source_statistics' ORDER BY position
----
1  id  text
2  worker_id  uint8
3  snapshot_committed  boolean
4  messages_received  uint8
5  updates_staged  uint8
6  updates_committed  uint8
7  bytes_received  uint8
8  envelope_state_bytes  uint8
9  envelope_state_count  uint8

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_source_statuses' ORDER BY position
----
1  id  text
2  name  text
3  type  text
4  last_status_change_at  timestamp␠with␠time␠zone
5  status  text
6  error  text
7  details  jsonb

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_source_status_history' ORDER BY position
----
1  occurred_at  timestamp␠with␠time␠zone
2  source_id  text
3  status  text
4  error  text
5  details  jsonb

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_subscriptions' ORDER BY position
----
1  id  text
2  session_id  uint4
3  cluster_id  text
4  created_at  timestamp␠with␠time␠zone
5  referenced_object_ids  list

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_active_peeks' ORDER BY position
----
1  id  uuid
2  index_id  text
3  time  mz_timestamp

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_arrangement_sharing' ORDER BY position
----
1  operator_id  uint8
2  count  bigint

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_arrangement_sizes' ORDER BY position
----
1  operator_id  uint8
2  records  numeric
3  batches  numeric

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_compute_delays_histogram' ORDER BY position
----
1  export_id  text
2  import_id  text
3  delay_ns  uint8
4  count  numeric

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_compute_dependencies' ORDER BY position
----
1  export_id  text
2  import_id  text

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_compute_exports' ORDER BY position
----
1  export_id  text
2  dataflow_id  uint8

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_compute_frontiers' ORDER BY position
----
1  export_id  text
2  time  mz_timestamp

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_compute_import_frontiers' ORDER BY position
----
1  export_id  text
2  import_id  text
3  time  mz_timestamp

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_compute_operator_durations_histogram' ORDER BY position
----
1  id  uint8
2  duration_ns  uint8
3  count  numeric

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_dataflows' ORDER BY position
----
1  id  uint8
2  name  text

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_dataflow_addresses' ORDER BY position
----
1  id  uint8
2  address  list

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_dataflow_channels' ORDER BY position
----
1  id  uint8
2  from_index  uint8
3  from_port  uint8
4  to_index  uint8
5  to_port  uint8

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_dataflow_channel_operators' ORDER BY position
----
1  id  uint8
2  from_operator_id  uint8
3  from_operator_address  list
4  to_operator_id  uint8
5  to_operator_address  list

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_dataflow_operators' ORDER BY position
----
1  id  uint8
2  name  text

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_dataflow_operator_dataflows' ORDER BY position
----
1  id  uint8
2  name  text
3  dataflow_id  uint8
4  dataflow_name  text

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_dataflow_operator_parents' ORDER BY position
----
1  id  uint8
2  parent_id  uint8

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_dataflow_arrangement_sizes' ORDER BY position
----
1  id  uint8
2  name  text
3  records  numeric
4  batches  numeric

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_message_counts' ORDER BY position
----
1  channel_id  uint8
2  sent  numeric
3  received  numeric

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_peek_durations_histogram' ORDER BY position
----
1  duration_ns  uint8
2  count  numeric

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_records_per_dataflow' ORDER BY position
----
1  id  uint8
2  name  text
3  records  numeric

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_records_per_dataflow_operator' ORDER BY position
----
1  id  uint8
2  name  text
3  dataflow_id  uint8
4  records  numeric

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_scheduling_elapsed' ORDER BY position
----
1  id  uint8
2  elapsed_ns  numeric

query ITT
SELECT position, name, type FROM objects WHERE schema = 'mz_internal' AND object = 'mz_scheduling_parks_histogram' ORDER BY position
----
1  slept_for_ns  uint8
2  requested_ns  uint8
3  count  numeric

query T
SELECT DISTINCT object FROM objects WHERE schema IN ('mz_internal') ORDER BY object
----
mz_active_peeks
mz_active_peeks_per_worker
mz_aggregates
mz_arrangement_batches_raw
mz_arrangement_records_raw
mz_arrangement_sharing
mz_arrangement_sharing_per_worker
mz_arrangement_sharing_raw
mz_arrangement_sizes
mz_arrangement_sizes_per_worker
mz_cluster_links
mz_cluster_replica_frontiers
mz_cluster_replica_heartbeats
mz_cluster_replica_history
mz_cluster_replica_metrics
mz_cluster_replica_sizes
mz_cluster_replica_statuses
mz_cluster_replica_utilization
mz_compute_delays_histogram
mz_compute_delays_histogram_per_worker
mz_compute_delays_histogram_raw
mz_compute_dependencies
mz_compute_dependencies_per_worker
mz_compute_exports
mz_compute_exports_per_worker
mz_compute_frontiers
mz_compute_frontiers_per_worker
mz_compute_import_frontiers
mz_compute_import_frontiers_per_worker
mz_compute_operator_durations_histogram
mz_compute_operator_durations_histogram_per_worker
mz_compute_operator_durations_histogram_raw
mz_dataflow_addresses
mz_dataflow_addresses_per_worker
mz_dataflow_arrangement_sizes
mz_dataflow_channel_operators
mz_dataflow_channel_operators_per_worker
mz_dataflow_channels
mz_dataflow_channels_per_worker
mz_dataflow_operator_dataflows
mz_dataflow_operator_dataflows_per_worker
mz_dataflow_operator_parents
mz_dataflow_operator_parents_per_worker
mz_dataflow_operator_reachability
mz_dataflow_operator_reachability_per_worker
mz_dataflow_operator_reachability_raw
mz_dataflow_operators
mz_dataflow_operators_per_worker
mz_dataflows
mz_dataflows_per_worker
mz_kafka_sources
mz_message_counts
mz_message_counts_per_worker
mz_message_counts_received_raw
mz_message_counts_sent_raw
mz_object_dependencies
mz_object_transitive_dependencies
mz_peek_durations_histogram
mz_peek_durations_histogram_per_worker
mz_peek_durations_histogram_raw
mz_postgres_sources
mz_records_per_dataflow
mz_records_per_dataflow_operator
mz_records_per_dataflow_operator_per_worker
mz_records_per_dataflow_per_worker
mz_scheduling_elapsed
mz_scheduling_elapsed_per_worker
mz_scheduling_elapsed_raw
mz_scheduling_parks_histogram
mz_scheduling_parks_histogram_per_worker
mz_scheduling_parks_histogram_raw
mz_sessions
mz_show_cluster_replicas
mz_show_indexes
mz_show_materialized_views
mz_sink_statistics
mz_sink_status_history
mz_sink_statuses
mz_source_statistics
mz_source_status_history
mz_source_statuses
mz_storage_shards
mz_storage_usage_by_shard
mz_subscriptions
mz_view_foreign_keys
mz_view_keys
