# Copyright Materialize, Inc. and contributors. All rights reserved.
#
# Use of this software is governed by the Business Source License
# included in the LICENSE file at the root of this repository.
#
# As of the Change Date specified in that file, in accordance with
# the Business Source License, use of this software will be governed
# by the Apache License, Version 2.0.

#######################################################
# This file is generated by gen_cluster_log_sinks.py. #
# Don't modify it directly!                           #
#######################################################

# Start from a pristine server state
reset-server

# Check that no log source has been created initially
query T
SELECT COUNT(*) FROM mz_sources WHERE name LIKE 'mz_active_peeks_%';
----
3

statement ok
CREATE CLUSTER c1 REPLICAS (r (SIZE '1'));

query T
SELECT COUNT(*) FROM mz_sources WHERE name LIKE 'mz_active_peeks_%';
----
4

statement ok
CREATE TABLE t1(f1 int, f2 int);

statement ok
INSERT INTO t1 VALUES (1,1),(2,3),(4,5);

statement ok
CREATE MATERIALIZED VIEW ma1 AS SELECT COUNT(*) FROM t1;

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_active_peeks) EXCEPT (SELECT * FROM mz_internal.mz_active_peeks_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_active_peeks_1) EXCEPT (SELECT * FROM mz_internal.mz_active_peeks));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_batches_internal) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_batches_internal_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_batches_internal_1) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_batches_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_records_internal) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_records_internal_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_records_internal_1) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_records_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_sharing) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_sharing_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_sharing_1) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_sharing));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_sharing_internal) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_sharing_internal_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_sharing_internal_1) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_sharing_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_sizes) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_sizes_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_sizes_1) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_sizes));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_compute_exports) EXCEPT (SELECT * FROM mz_internal.mz_compute_exports_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_compute_exports_1) EXCEPT (SELECT * FROM mz_internal.mz_compute_exports));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_compute_frontiers) EXCEPT (SELECT * FROM mz_internal.mz_compute_frontiers_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_compute_frontiers_1) EXCEPT (SELECT * FROM mz_internal.mz_compute_frontiers));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_compute_import_frontiers) EXCEPT (SELECT * FROM mz_internal.mz_compute_import_frontiers_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_compute_import_frontiers_1) EXCEPT (SELECT * FROM mz_internal.mz_compute_import_frontiers));
----

query T
SELECT id,worker_id FROM ((SELECT id,worker_id FROM mz_internal.mz_dataflow_addresses) EXCEPT (SELECT id,worker_id FROM mz_internal.mz_dataflow_addresses_1));
----

query T
SELECT id,worker_id FROM ((SELECT id,worker_id FROM mz_internal.mz_dataflow_addresses_1) EXCEPT (SELECT id,worker_id FROM mz_internal.mz_dataflow_addresses));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflow_channels) EXCEPT (SELECT * FROM mz_internal.mz_dataflow_channels_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflow_channels_1) EXCEPT (SELECT * FROM mz_internal.mz_dataflow_channels));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflow_channel_operators) EXCEPT (SELECT * FROM mz_internal.mz_dataflow_channel_operators_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflow_channel_operators_1) EXCEPT (SELECT * FROM mz_internal.mz_dataflow_channel_operators));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflow_operator_dataflows) EXCEPT (SELECT * FROM mz_internal.mz_dataflow_operator_dataflows_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflow_operator_dataflows_1) EXCEPT (SELECT * FROM mz_internal.mz_dataflow_operator_dataflows));
----

query T
SELECT port,worker_id,update_type FROM ((SELECT port,worker_id,update_type FROM mz_internal.mz_dataflow_operator_reachability) EXCEPT (SELECT port,worker_id,update_type FROM mz_internal.mz_dataflow_operator_reachability_1));
----

query T
SELECT port,worker_id,update_type FROM ((SELECT port,worker_id,update_type FROM mz_internal.mz_dataflow_operator_reachability_1) EXCEPT (SELECT port,worker_id,update_type FROM mz_internal.mz_dataflow_operator_reachability));
----

query T
SELECT port,worker_id,update_type FROM ((SELECT port,worker_id,update_type FROM mz_internal.mz_dataflow_operator_reachability_internal) EXCEPT (SELECT port,worker_id,update_type FROM mz_internal.mz_dataflow_operator_reachability_internal_1));
----

query T
SELECT port,worker_id,update_type FROM ((SELECT port,worker_id,update_type FROM mz_internal.mz_dataflow_operator_reachability_internal_1) EXCEPT (SELECT port,worker_id,update_type FROM mz_internal.mz_dataflow_operator_reachability_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflow_operators) EXCEPT (SELECT * FROM mz_internal.mz_dataflow_operators_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflow_operators_1) EXCEPT (SELECT * FROM mz_internal.mz_dataflow_operators));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflows) EXCEPT (SELECT * FROM mz_internal.mz_dataflows_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflows_1) EXCEPT (SELECT * FROM mz_internal.mz_dataflows));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_message_counts) EXCEPT (SELECT * FROM mz_internal.mz_message_counts_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_message_counts_1) EXCEPT (SELECT * FROM mz_internal.mz_message_counts));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_message_counts_received_internal) EXCEPT (SELECT * FROM mz_internal.mz_message_counts_received_internal_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_message_counts_received_internal_1) EXCEPT (SELECT * FROM mz_internal.mz_message_counts_received_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_message_counts_sent_internal) EXCEPT (SELECT * FROM mz_internal.mz_message_counts_sent_internal_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_message_counts_sent_internal_1) EXCEPT (SELECT * FROM mz_internal.mz_message_counts_sent_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_peek_durations_histogram) EXCEPT (SELECT * FROM mz_internal.mz_peek_durations_histogram_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_peek_durations_histogram_1) EXCEPT (SELECT * FROM mz_internal.mz_peek_durations_histogram));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_peek_durations_histogram_internal) EXCEPT (SELECT * FROM mz_internal.mz_peek_durations_histogram_internal_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_peek_durations_histogram_internal_1) EXCEPT (SELECT * FROM mz_internal.mz_peek_durations_histogram_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_records_per_dataflow) EXCEPT (SELECT * FROM mz_internal.mz_records_per_dataflow_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_records_per_dataflow_1) EXCEPT (SELECT * FROM mz_internal.mz_records_per_dataflow));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_records_per_dataflow_global) EXCEPT (SELECT * FROM mz_internal.mz_records_per_dataflow_global_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_records_per_dataflow_global_1) EXCEPT (SELECT * FROM mz_internal.mz_records_per_dataflow_global));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_records_per_dataflow_operator) EXCEPT (SELECT * FROM mz_internal.mz_records_per_dataflow_operator_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_records_per_dataflow_operator_1) EXCEPT (SELECT * FROM mz_internal.mz_records_per_dataflow_operator));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_scheduling_elapsed) EXCEPT (SELECT * FROM mz_internal.mz_scheduling_elapsed_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_scheduling_elapsed_1) EXCEPT (SELECT * FROM mz_internal.mz_scheduling_elapsed));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_scheduling_elapsed_internal) EXCEPT (SELECT * FROM mz_internal.mz_scheduling_elapsed_internal_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_scheduling_elapsed_internal_1) EXCEPT (SELECT * FROM mz_internal.mz_scheduling_elapsed_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_scheduling_parks_histogram) EXCEPT (SELECT * FROM mz_internal.mz_scheduling_parks_histogram_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_scheduling_parks_histogram_1) EXCEPT (SELECT * FROM mz_internal.mz_scheduling_parks_histogram));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_scheduling_parks_histogram_internal) EXCEPT (SELECT * FROM mz_internal.mz_scheduling_parks_histogram_internal_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_scheduling_parks_histogram_internal_1) EXCEPT (SELECT * FROM mz_internal.mz_scheduling_parks_histogram_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_delays_histogram) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_delays_histogram_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_delays_histogram_1) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_delays_histogram));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_delays_histogram_internal) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_delays_histogram_internal_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_delays_histogram_internal_1) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_delays_histogram_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_dependencies) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_dependencies_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_dependencies_1) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_dependencies));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_frontiers) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_frontiers_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_frontiers_1) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_frontiers));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_import_frontiers) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_import_frontiers_1));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_import_frontiers_1) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_import_frontiers));
----

statement ok
SET CLUSTER TO c1;

statement ok
CREATE MATERIALIZED VIEW ma2 AS SELECT COUNT(*) FROM t1;

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_active_peeks) EXCEPT (SELECT * FROM mz_internal.mz_active_peeks_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_active_peeks_4) EXCEPT (SELECT * FROM mz_internal.mz_active_peeks));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_batches_internal) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_batches_internal_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_batches_internal_4) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_batches_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_records_internal) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_records_internal_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_records_internal_4) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_records_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_sharing) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_sharing_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_sharing_4) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_sharing));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_sharing_internal) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_sharing_internal_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_sharing_internal_4) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_sharing_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_sizes) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_sizes_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_sizes_4) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_sizes));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_compute_exports) EXCEPT (SELECT * FROM mz_internal.mz_compute_exports_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_compute_exports_4) EXCEPT (SELECT * FROM mz_internal.mz_compute_exports));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_compute_frontiers) EXCEPT (SELECT * FROM mz_internal.mz_compute_frontiers_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_compute_frontiers_4) EXCEPT (SELECT * FROM mz_internal.mz_compute_frontiers));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_compute_import_frontiers) EXCEPT (SELECT * FROM mz_internal.mz_compute_import_frontiers_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_compute_import_frontiers_4) EXCEPT (SELECT * FROM mz_internal.mz_compute_import_frontiers));
----

query T
SELECT id,worker_id FROM ((SELECT id,worker_id FROM mz_internal.mz_dataflow_addresses) EXCEPT (SELECT id,worker_id FROM mz_internal.mz_dataflow_addresses_4));
----

query T
SELECT id,worker_id FROM ((SELECT id,worker_id FROM mz_internal.mz_dataflow_addresses_4) EXCEPT (SELECT id,worker_id FROM mz_internal.mz_dataflow_addresses));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflow_channels) EXCEPT (SELECT * FROM mz_internal.mz_dataflow_channels_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflow_channels_4) EXCEPT (SELECT * FROM mz_internal.mz_dataflow_channels));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflow_channel_operators) EXCEPT (SELECT * FROM mz_internal.mz_dataflow_channel_operators_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflow_channel_operators_4) EXCEPT (SELECT * FROM mz_internal.mz_dataflow_channel_operators));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflow_operator_dataflows) EXCEPT (SELECT * FROM mz_internal.mz_dataflow_operator_dataflows_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflow_operator_dataflows_4) EXCEPT (SELECT * FROM mz_internal.mz_dataflow_operator_dataflows));
----

query T
SELECT port,worker_id,update_type FROM ((SELECT port,worker_id,update_type FROM mz_internal.mz_dataflow_operator_reachability) EXCEPT (SELECT port,worker_id,update_type FROM mz_internal.mz_dataflow_operator_reachability_4));
----

query T
SELECT port,worker_id,update_type FROM ((SELECT port,worker_id,update_type FROM mz_internal.mz_dataflow_operator_reachability_4) EXCEPT (SELECT port,worker_id,update_type FROM mz_internal.mz_dataflow_operator_reachability));
----

query T
SELECT port,worker_id,update_type FROM ((SELECT port,worker_id,update_type FROM mz_internal.mz_dataflow_operator_reachability_internal) EXCEPT (SELECT port,worker_id,update_type FROM mz_internal.mz_dataflow_operator_reachability_internal_4));
----

query T
SELECT port,worker_id,update_type FROM ((SELECT port,worker_id,update_type FROM mz_internal.mz_dataflow_operator_reachability_internal_4) EXCEPT (SELECT port,worker_id,update_type FROM mz_internal.mz_dataflow_operator_reachability_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflow_operators) EXCEPT (SELECT * FROM mz_internal.mz_dataflow_operators_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflow_operators_4) EXCEPT (SELECT * FROM mz_internal.mz_dataflow_operators));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflows) EXCEPT (SELECT * FROM mz_internal.mz_dataflows_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflows_4) EXCEPT (SELECT * FROM mz_internal.mz_dataflows));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_message_counts) EXCEPT (SELECT * FROM mz_internal.mz_message_counts_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_message_counts_4) EXCEPT (SELECT * FROM mz_internal.mz_message_counts));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_message_counts_received_internal) EXCEPT (SELECT * FROM mz_internal.mz_message_counts_received_internal_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_message_counts_received_internal_4) EXCEPT (SELECT * FROM mz_internal.mz_message_counts_received_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_message_counts_sent_internal) EXCEPT (SELECT * FROM mz_internal.mz_message_counts_sent_internal_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_message_counts_sent_internal_4) EXCEPT (SELECT * FROM mz_internal.mz_message_counts_sent_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_peek_durations_histogram) EXCEPT (SELECT * FROM mz_internal.mz_peek_durations_histogram_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_peek_durations_histogram_4) EXCEPT (SELECT * FROM mz_internal.mz_peek_durations_histogram));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_peek_durations_histogram_internal) EXCEPT (SELECT * FROM mz_internal.mz_peek_durations_histogram_internal_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_peek_durations_histogram_internal_4) EXCEPT (SELECT * FROM mz_internal.mz_peek_durations_histogram_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_records_per_dataflow) EXCEPT (SELECT * FROM mz_internal.mz_records_per_dataflow_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_records_per_dataflow_4) EXCEPT (SELECT * FROM mz_internal.mz_records_per_dataflow));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_records_per_dataflow_global) EXCEPT (SELECT * FROM mz_internal.mz_records_per_dataflow_global_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_records_per_dataflow_global_4) EXCEPT (SELECT * FROM mz_internal.mz_records_per_dataflow_global));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_records_per_dataflow_operator) EXCEPT (SELECT * FROM mz_internal.mz_records_per_dataflow_operator_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_records_per_dataflow_operator_4) EXCEPT (SELECT * FROM mz_internal.mz_records_per_dataflow_operator));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_scheduling_elapsed) EXCEPT (SELECT * FROM mz_internal.mz_scheduling_elapsed_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_scheduling_elapsed_4) EXCEPT (SELECT * FROM mz_internal.mz_scheduling_elapsed));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_scheduling_elapsed_internal) EXCEPT (SELECT * FROM mz_internal.mz_scheduling_elapsed_internal_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_scheduling_elapsed_internal_4) EXCEPT (SELECT * FROM mz_internal.mz_scheduling_elapsed_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_scheduling_parks_histogram) EXCEPT (SELECT * FROM mz_internal.mz_scheduling_parks_histogram_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_scheduling_parks_histogram_4) EXCEPT (SELECT * FROM mz_internal.mz_scheduling_parks_histogram));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_scheduling_parks_histogram_internal) EXCEPT (SELECT * FROM mz_internal.mz_scheduling_parks_histogram_internal_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_scheduling_parks_histogram_internal_4) EXCEPT (SELECT * FROM mz_internal.mz_scheduling_parks_histogram_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_delays_histogram) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_delays_histogram_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_delays_histogram_4) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_delays_histogram));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_delays_histogram_internal) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_delays_histogram_internal_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_delays_histogram_internal_4) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_delays_histogram_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_dependencies) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_dependencies_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_dependencies_4) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_dependencies));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_frontiers) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_frontiers_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_frontiers_4) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_frontiers));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_import_frontiers) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_import_frontiers_4));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_import_frontiers_4) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_import_frontiers));
----

statement ok
CREATE CLUSTER c2 REPLICAS (r1 (SIZE '1'), r2 (SIZE '1'));

query T
SELECT COUNT(*) FROM mz_sources WHERE name LIKE 'mz_active_peeks_%';
----
6

statement ok
set cluster = c2;

statement ok
set cluster_replica = r1;

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_active_peeks) EXCEPT (SELECT * FROM mz_internal.mz_active_peeks_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_active_peeks_5) EXCEPT (SELECT * FROM mz_internal.mz_active_peeks));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_batches_internal) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_batches_internal_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_batches_internal_5) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_batches_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_records_internal) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_records_internal_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_records_internal_5) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_records_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_sharing) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_sharing_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_sharing_5) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_sharing));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_sharing_internal) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_sharing_internal_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_sharing_internal_5) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_sharing_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_sizes) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_sizes_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_arrangement_sizes_5) EXCEPT (SELECT * FROM mz_internal.mz_arrangement_sizes));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_compute_exports) EXCEPT (SELECT * FROM mz_internal.mz_compute_exports_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_compute_exports_5) EXCEPT (SELECT * FROM mz_internal.mz_compute_exports));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_compute_frontiers) EXCEPT (SELECT * FROM mz_internal.mz_compute_frontiers_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_compute_frontiers_5) EXCEPT (SELECT * FROM mz_internal.mz_compute_frontiers));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_compute_import_frontiers) EXCEPT (SELECT * FROM mz_internal.mz_compute_import_frontiers_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_compute_import_frontiers_5) EXCEPT (SELECT * FROM mz_internal.mz_compute_import_frontiers));
----

query T
SELECT id,worker_id FROM ((SELECT id,worker_id FROM mz_internal.mz_dataflow_addresses) EXCEPT (SELECT id,worker_id FROM mz_internal.mz_dataflow_addresses_5));
----

query T
SELECT id,worker_id FROM ((SELECT id,worker_id FROM mz_internal.mz_dataflow_addresses_5) EXCEPT (SELECT id,worker_id FROM mz_internal.mz_dataflow_addresses));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflow_channels) EXCEPT (SELECT * FROM mz_internal.mz_dataflow_channels_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflow_channels_5) EXCEPT (SELECT * FROM mz_internal.mz_dataflow_channels));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflow_channel_operators) EXCEPT (SELECT * FROM mz_internal.mz_dataflow_channel_operators_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflow_channel_operators_5) EXCEPT (SELECT * FROM mz_internal.mz_dataflow_channel_operators));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflow_operator_dataflows) EXCEPT (SELECT * FROM mz_internal.mz_dataflow_operator_dataflows_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflow_operator_dataflows_5) EXCEPT (SELECT * FROM mz_internal.mz_dataflow_operator_dataflows));
----

query T
SELECT port,worker_id,update_type FROM ((SELECT port,worker_id,update_type FROM mz_internal.mz_dataflow_operator_reachability) EXCEPT (SELECT port,worker_id,update_type FROM mz_internal.mz_dataflow_operator_reachability_5));
----

query T
SELECT port,worker_id,update_type FROM ((SELECT port,worker_id,update_type FROM mz_internal.mz_dataflow_operator_reachability_5) EXCEPT (SELECT port,worker_id,update_type FROM mz_internal.mz_dataflow_operator_reachability));
----

query T
SELECT port,worker_id,update_type FROM ((SELECT port,worker_id,update_type FROM mz_internal.mz_dataflow_operator_reachability_internal) EXCEPT (SELECT port,worker_id,update_type FROM mz_internal.mz_dataflow_operator_reachability_internal_5));
----

query T
SELECT port,worker_id,update_type FROM ((SELECT port,worker_id,update_type FROM mz_internal.mz_dataflow_operator_reachability_internal_5) EXCEPT (SELECT port,worker_id,update_type FROM mz_internal.mz_dataflow_operator_reachability_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflow_operators) EXCEPT (SELECT * FROM mz_internal.mz_dataflow_operators_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflow_operators_5) EXCEPT (SELECT * FROM mz_internal.mz_dataflow_operators));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflows) EXCEPT (SELECT * FROM mz_internal.mz_dataflows_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_dataflows_5) EXCEPT (SELECT * FROM mz_internal.mz_dataflows));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_message_counts) EXCEPT (SELECT * FROM mz_internal.mz_message_counts_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_message_counts_5) EXCEPT (SELECT * FROM mz_internal.mz_message_counts));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_message_counts_received_internal) EXCEPT (SELECT * FROM mz_internal.mz_message_counts_received_internal_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_message_counts_received_internal_5) EXCEPT (SELECT * FROM mz_internal.mz_message_counts_received_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_message_counts_sent_internal) EXCEPT (SELECT * FROM mz_internal.mz_message_counts_sent_internal_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_message_counts_sent_internal_5) EXCEPT (SELECT * FROM mz_internal.mz_message_counts_sent_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_peek_durations_histogram) EXCEPT (SELECT * FROM mz_internal.mz_peek_durations_histogram_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_peek_durations_histogram_5) EXCEPT (SELECT * FROM mz_internal.mz_peek_durations_histogram));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_peek_durations_histogram_internal) EXCEPT (SELECT * FROM mz_internal.mz_peek_durations_histogram_internal_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_peek_durations_histogram_internal_5) EXCEPT (SELECT * FROM mz_internal.mz_peek_durations_histogram_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_records_per_dataflow) EXCEPT (SELECT * FROM mz_internal.mz_records_per_dataflow_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_records_per_dataflow_5) EXCEPT (SELECT * FROM mz_internal.mz_records_per_dataflow));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_records_per_dataflow_global) EXCEPT (SELECT * FROM mz_internal.mz_records_per_dataflow_global_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_records_per_dataflow_global_5) EXCEPT (SELECT * FROM mz_internal.mz_records_per_dataflow_global));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_records_per_dataflow_operator) EXCEPT (SELECT * FROM mz_internal.mz_records_per_dataflow_operator_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_records_per_dataflow_operator_5) EXCEPT (SELECT * FROM mz_internal.mz_records_per_dataflow_operator));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_scheduling_elapsed) EXCEPT (SELECT * FROM mz_internal.mz_scheduling_elapsed_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_scheduling_elapsed_5) EXCEPT (SELECT * FROM mz_internal.mz_scheduling_elapsed));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_scheduling_elapsed_internal) EXCEPT (SELECT * FROM mz_internal.mz_scheduling_elapsed_internal_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_scheduling_elapsed_internal_5) EXCEPT (SELECT * FROM mz_internal.mz_scheduling_elapsed_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_scheduling_parks_histogram) EXCEPT (SELECT * FROM mz_internal.mz_scheduling_parks_histogram_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_scheduling_parks_histogram_5) EXCEPT (SELECT * FROM mz_internal.mz_scheduling_parks_histogram));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_scheduling_parks_histogram_internal) EXCEPT (SELECT * FROM mz_internal.mz_scheduling_parks_histogram_internal_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_scheduling_parks_histogram_internal_5) EXCEPT (SELECT * FROM mz_internal.mz_scheduling_parks_histogram_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_delays_histogram) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_delays_histogram_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_delays_histogram_5) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_delays_histogram));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_delays_histogram_internal) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_delays_histogram_internal_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_delays_histogram_internal_5) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_delays_histogram_internal));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_dependencies) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_dependencies_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_dependencies_5) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_dependencies));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_frontiers) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_frontiers_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_frontiers_5) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_frontiers));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_import_frontiers) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_import_frontiers_5));
----

query T
SELECT * FROM ((SELECT * FROM mz_internal.mz_worker_compute_import_frontiers_5) EXCEPT (SELECT * FROM mz_internal.mz_worker_compute_import_frontiers));
----
