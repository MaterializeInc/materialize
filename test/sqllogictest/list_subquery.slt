# Copyright Materialize, Inc. and contributors. All rights reserved.
#
# Use of this software is governed by the Business Source License
# included in the LICENSE file at the root of this repository.
#
# As of the Change Date specified in that file, in accordance with
# the Business Source License, use of this software will be governed
# by the Apache License, Version 2.0.

mode standard

statement ok
CREATE TABLE xs (x int not null)

statement ok
CREATE TABLE ys (y int not null)

statement ok
INSERT INTO xs VALUES (1), (1), (2);

statement ok
INSERT INTO ys VALUES (2), (4), (5);

statement ok
SELECT (LIST[1])::text

### List subqueries ###
statement ok
SELECT LIST(SELECT x FROM xs)::text

query T
SELECT LIST(SELECT x FROM xs)::text
----
{1,1,2}

query T
SELECT LIST(SELECT x FROM xs WHERE x > 1)::text
----
{2}

query T
SELECT LIST[LIST(SELECT x FROM xs)]::text
----
{{1,1,2}}

query T
SELECT LIST(SELECT x FROM xs LIMIT 2)::text
----
{{1,1}}

query T
SELECT LIST(SELECT x FROM xs ORDER BY x DESC)::text
----
{{2,1,1}}

query T
SELECT LIST(SELECT x FROM xs ORDER BY x DESC LIMIT 2)::text
----
{{2,1}}

query T
SELECT LIST[LIST(SELECT x FROM xs), LIST(SELECT y FROM ys)]::text
----
{{1,1,2},{2,4,5}}

query T
SELECT list_cat(LIST(SELECT x FROM xs), LIST(SELECT y FROM ys))::text
----
{{1,1,2,2,4,5}}

query T
SELECT list_cat(LIST(SELECT x FROM xs), LIST(SELECT y FROM ys ORDER BY y DESC))::text
----
{1,1,2,5,4,2}

query T
SELECT LIST(SELECT x FROM xs JOIN ys ON xs.x = ys.y)::text
----
{2}
