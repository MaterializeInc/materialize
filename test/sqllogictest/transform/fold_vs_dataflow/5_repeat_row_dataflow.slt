# Copyright Materialize, Inc. and contributors. All rights reserved.
#
# Use of this software is governed by the Business Source License
# included in the LICENSE file at the root of this repository.
#
# As of the Change Date specified in that file, in accordance with
# the Business Source License, use of this software will be governed
# by the Apache License, Version 2.0.

mode cockroach

# -------------------------------
# repeat row (=> this panics!)
# -------------------------------

statement ok
CREATE TABLE t_base (data int, diff bigint);

statement ok
INSERT INTO t_base VALUES (1, 9223372036854775807);

statement ok
INSERT INTO t_base VALUES (1, 9223372036854775807);

# statement ok
# CREATE MATERIALIZED VIEW mv_using_dataflow_rendering AS
#  SELECT data FROM t_base, repeat_row(diff);

# query I
# SELECT SUM(data)
# FROM mv_using_dataflow_rendering;
# ----

# query T multiline
# EXPLAIN SELECT SUM(data)
# FROM mv_using_dataflow_rendering;
# ----
# EOF
